<app-grid-layout [state]="'detail'">
    <mat-tab-group class="w-full !max-w-screen-2xl" preserveContent (selectedTabChange)="changeTab($event)">
        <mat-tab [label]="'sidebar.COMPANY_PROFILE' | translate">


            @if (!loading) {
            <div
                class="w-full md:h-[calc(100vh-170px)] h-[calc(100vh-157px)] pt-4 md:pt-5 overflow-y-auto scrollbar-none ">

                <div
                    class="bg-neutral-100 border-detail m-1  p-3 md:py-4 md:px-5 gap-y-4 md:gap-y-5 flex flex-col  rounded-lg md:rounded-xl">

                    <div class="w-full flex items-center justify-between">
                        <app-title [title]="'sidebar.COMPANY_PROFILE' | translate"></app-title>
                        <app-edit-btn (click)="goToEditInfo()"></app-edit-btn>
                    </div>

                    <div
                        class="w-full py-3 px-4 md:rtl:pr-10 md:rtl:pl-5 md:ltr:pr-5 md:ltr:pl-10 rounded-lg flex justify-between  bg-white">
                        <div class="w-full flex items-center gap-x-4 ">
                            <!-- border color active -> neutral-400 -->
                            <div
                                class="relative  min-w-14 min-h-14 max-w-14 max-h-14 md:min-w-[104px] md:max-w-[104px] md:min-h-[104px] md:max-h-[104px] rounded-full border border-neutral-300 flex items-center">
                                <!-- <span [appIcon]="icons.check"
                                        class="w-4 h-4 md:w-6 md:h-6 bg-success-700 text-pure-white rounded-full flex items-center justify-center absolute bottom-0 md:bottom-1 ltr:left-0 rlt:right-0"></span> -->
                                <a [href]="company?.logoImgPath! | image : false" target="_blank" class="w-full h-full">
                                    <img [src]="company?.logoImgPath! | image : false"
                                        class="w-full md:min-h-[104px] md:max-h-[104px] rounded-full"
                                        [alt]="company?.primaryTitle"
                                        onerror="this.onerror=null;this.src='images/default-company.png'" />
                                </a>
                            </div>

                            <div class="w-full flex max-md:flex-col items-center justify-between">
                                <div class="max-md:w-full flex flex-col gap-y-2">
                                    <span class="text-neutral-900 md:text-lg">{{company?.primaryTitle ?? '-'}}</span>
                                    <span class="text-neutral-600 text-sm">{{company?.secondaryTitle ?? '-'}}</span>
                                </div>
                                <div class="max-md:w-full flex justify-end">
                                    <span class="px-2 rounded-full bg-info-200 flex text-info-900 max-md:text-sm">
                                        {{company?.companyType ? (('panel.company_types.'+(company?.companyType |
                                        uppercase)) | translate) : '-'}}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-col gap-y-3 md:gap-y-4 h-auto">
                        <h3 class="text-neutral-700 max-md:text-sm font-medium">
                            {{'panel.company_profile.COMPANY_REGISTRATION_INFORMATION' | translate}}
                        </h3>
                        <div
                            class="w-full h-auto grid grid-cols-1 md:grid-cols-2 2xl:grid-cols-4 gap-y-3 md:gap-4 rounded-lg">

                            <div
                                class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                <div
                                    class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                    <p class="text-primary-500 font-medium">
                                        {{'panel.company_profile.REGISTRATION_NUMBER' | translate}}</p>
                                    <span class="text-neutral-500 text-wrap max-w-full">{{company?.registrationNumber
                                        ?? '-'}}</span>
                                </div>
                            </div>

                            <div
                                class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                <div
                                    class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                    <p class="text-primary-500 font-medium">{{'panel.company_profile.NATIONAL_ID'
                                        | translate}}</p>
                                    <span class="text-sm text-neutral-500">{{company?.nationalBusinessIdNumber ??
                                        '-'}}</span>
                                </div>
                            </div>
                            <div
                                class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                <div
                                    class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                    <p class="text-primary-500 font-medium">
                                        {{'panel.company_profile.ECONOMIC_CODE' | translate}}</p>
                                    <span class="text-sm text-neutral-500">{{company?.taxIdNumber ?? '-'}}</span>
                                </div>
                            </div>
                            <div
                                class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                <div
                                    class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                    <p class="text-primary-500 font-medium">{{'general.forms.NATIONAL_CODE' |
                                        translate}}</p>
                                    <span class="text-sm text-neutral-500">{{company?.nationalIdNumber ??
                                        '-'}}</span>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="flex flex-col gap-y-3 md:gap-y-4">
                        <h3 class="text-neutral-700 max-md:text-sm font-medium">{{'general.CONTACT_INFORMATION' |
                            translate}}
                        </h3>
                        <div class="flex flex-col gap-y-3 md:gap-4 ">

                            <div class="w-full grid grid-cols-1 md:grid-cols-3 gap-y-3 md:gap-4 rounded-lg">
                                <div
                                    class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                    <div
                                        class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                        <p class="text-primary-500 font-medium">
                                            {{'panel.company_profile.PHONE_NUMBER' | translate}}</p>
                                        <span class="text-sm text-neutral-500">{{company?.phoneNumber ?? '-'}}</span>
                                    </div>
                                </div>
                                <div
                                    class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                    <div
                                        class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                        <p class="text-primary-500 font-medium">{{'general.forms.MOBILE_NUMBER' |
                                            translate}}</p>
                                        <span class="text-sm text-neutral-500">{{company?.cellPhoneNumber ??
                                            '-'}}</span>
                                    </div>
                                </div>
                                <div
                                    class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                    <div
                                        class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                        <p class="text-primary-500 font-medium">{{'panel.company_profile.EMAIL' |
                                            translate}}</p>
                                        <span class="text-sm text-neutral-500">{{company?.emailAddress ??
                                            '-'}}</span>
                                    </div>
                                </div>

                            </div>
                            <div class="w-full grid grid-cols-1 md:grid-cols-2 gap-y-3 md:gap-4 rounded-lg">
                                <div
                                    class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                    <div
                                        class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                        <p class="text-primary-500 font-medium">
                                            {{'panel.company_profile.WEBSITE_ADDRESS' | translate}}</p>
                                        <a class="text-sm text-neutral-800" [href]="company?.websiteURL"
                                            target="_blank">{{company?.websiteURL ?? '-'}}</a>
                                    </div>
                                </div>
                                <div
                                    class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg min-h-[73px] md:min-h-[88px] flex">
                                    <div
                                        class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4 min-h-14 md:min-h-16 max-h-fit">
                                        <p class="text-primary-500 font-medium">{{'panel.company_profile.FAX' |
                                            translate}}</p>
                                        <span class="text-sm text-neutral-500">{{company?.faxNumber ?? '-'}}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <app-issuer-by [issuer]="{
                                    createdBy: company?.createdBy!,
                                    createdAt: company?.createdAt!,
                                    updatedBy: company?.updatedBy!,
                                    updatedAt: company?.updatedAt!
                                }"></app-issuer-by>




                </div>



            </div>
            }@else {
            <div class="w-full  pt-7 md:pt-9 flex items-center justify-center">
                <app-page-loading></app-page-loading>
            </div>
            }


        </mat-tab>

        <mat-tab [label]="'general.ADDRESSES'| translate">
            <div class="w-full  pt-4 md:pt-6 flex flex-col justify-between">
                @if (!addressLoading) {
                @if (totalItems > 0) {
                <div
                    class="w-full md:h-[calc(100vh-250px)] h-[calc(100vh-222px)]  overflow-y-auto  scrollbar-none flex flex-col gap-y-4 md:gap-y-5">

                    <div class="h-full flex flex-col  gap-y-4 md:gap-y-5">
                        @for (item of addresses; track $index; let i = $index) {
                        <div class="p-3 md:py-4 md:px-5 mx-1 bg-neutral-100 border-detail  rounded-lg flex flex-col gap-y-3 md:gap-y-4">

                            <div class="w-full pb-4 md:pb-6 flex items-center justify-between">

                                <span class="text-primary-600 font-bold md:text-lg">
                                    {{'general.forms.ADDRESS' | translate}}
                                    {{i+1}}
                                </span>

                                <div class="flex items-center gap-x-2 md:gap-x-5">
                                    <button type="button" (click)="goToEditAddress(item.id)"
                                        class="flex items-center gap-x-1 text-neutral-700 font-medium cursor-pointer">
                                        <span [appIcon]="icons.edit" class="flex text-xl text-neutral-900"></span>
                                        <span class="max-md:hidden">{{'general.buttons.EDIT' | translate}}</span>
                                    </button>
                                    <button type="button" (click)="deleteAddress(item.id)"
                                        class="flex items-center gap-x-1 text-error-600 font-medium cursor-pointer">
                                        <span [appIcon]="icons.delete" class="flex text-xl text-error-600"></span>
                                        <span class="max-md:hidden">{{'general.DELETE' | translate}}</span>
                                    </button>
                                </div>
                            </div>

                            <div class="w-full grid grid-cols-1 md:grid-cols-2  gap-y-3 md:gap-4 ">
                                <div class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg ">
                                    <div
                                        class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4">
                                        <p class="text-primary-500 font-medium">
                                            {{'panel.company_profile.BRANCH' | translate}}</p>
                                        <span class="text-neutral-500 text-wrap max-w-full">{{item?.branch?.primaryTitle
                                            ?? '-'}}</span>
                                    </div>
                                </div>
                                <div class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg ">
                                    <div
                                        class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4">
                                        <p class="text-primary-500 font-medium">
                                            {{'general.forms.POSTAL_CODE' | translate}}</p>
                                        <span class="text-neutral-500 text-wrap max-w-full">{{item?.postalCode ??
                                            '-'}}</span>
                                    </div>
                                </div>
                                <div class="p-2 md:p-3 bg-neutral-50 rounded-md md:rounded-lg md:col-span-full">
                                    <div
                                        class="flex flex-col justify-center gap-y-3 text-sm rtl:border-r ltr:border-l border-primary-300 px-4">
                                        <p class="text-primary-500 font-medium">
                                            {{'panel.bank_management.ADDRESS' | translate}}</p>
                                        <span class="text-neutral-500 text-wrap max-w-full">{{item?.address ??
                                            '-'}}</span>
                                    </div>
                                </div>

                            </div>
                        </div>
                        }
                        
                        <div class="pb-2 md:pb-4">
                            <app-pagination [totalCount]="totalItems" [pageIndex]="pageInfo.pageNumber"
                                [pageSize]="pageInfo.pageSize"></app-pagination>
                        </div>
                    </div>

                </div>

                <div
                    class="w-full flex items-center justify-between gap-x-3 border-t border-t-neutral-300 pt-2 md:pt-3">
                    <app-add-btn class="" (click)="addAddress()">
                        <span [appIcon]="icons.add" class="flex md:text-xl"></span>
                        {{'panel.company_profile.ADD_ADDRESS' | translate}}
                    </app-add-btn>
                </div>

                }@else {
                <div class="w-full h-full flex flex-col items-center justify-center gap-y-14 py-10">
                    <img src="{{'location' | image}}" class="!w-[85px] !h-[105px] md:!w-[108px] md:!h-[130px]"
                        alt="location" />

                    <h4 class="md:text-xl text-neutral-900 font-bold">
                        {{'general.NO_ADDRESS_HAS_BEEN_REGISTERED_YET' | translate}}</h4>

                    <div class="w-full flex flex-col justify-center items-center gap-y-5">
                        <app-add-btn class="w-full md:w-[337px] flex items-center justify-center [&>button]:gap-x-2"
                            (click)="addAddress()">
                            <span [appIcon]="icons.add" class="text-xl flex"></span>
                            {{'panel.bank_management.ADD_ADDRESS' | translate}}
                        </app-add-btn>
                    </div>
                </div>
                }
                }@else {
                <app-page-loading class="flex justify-center"></app-page-loading>
                }
            </div>
        </mat-tab>
    </mat-tab-group>

</app-grid-layout>